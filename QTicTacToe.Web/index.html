<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEE Test</title>
</head>
<body>
    <input id="isMockupServer" type="checkbox" onchange="updateServerType(this)">Is mock up server?</input>
    <hr />
    <button onclick="connect()">Connect</button>
    <button onclick="testMove()">Send move</button>
    <script>
        const mockupMove = {
            x: 1,
            y: 1,
            z: 1
        };

        const mockupBackendUrl = "https://4ced842e-f28b-44bf-9b00-1a38fbacfdbb.mock.pstmn.io";
        const testBackendUrl = "http://localhost:5098";

        var isMockUpServerChk = document.getElementById('isMockupServer');
        var backendUrl;
        updateServerType(isMockUpServerChk);

        function updateServerType(isMockUpServerChk) {
            backendUrl = isMockUpServerChk.checked
                ? mockupBackendUrl
                : testBackendUrl;
        }

        async function testMove() {
            let requestUrl = `${backendUrl}/move?client_id=123`;
            console.log(requestUrl);

            const response = await fetch(requestUrl, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify(mockupMove)
            });
            const jsonResponse = await response.json();
            console.log('Move sent - response: ', jsonResponse);
        }

        function connect() {
            const evtSource = new EventSource(`${backendUrl}/connect?client_id=123`);

            evtSource.onmessage = (evt) => {
                console.log(evt.data);
            }
        }
    </script>
</body>
</html>